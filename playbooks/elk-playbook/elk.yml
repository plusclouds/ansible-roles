- hosts: master
  become: yes
  become_user: root
  tasks:
    - import_tasks: tasks/check.yml
  roles:
    - { role: ntp, tags: ['ntp'] }
    - { role: python, tags: [ 'python' ]  }    
    - { role: elasticsearch, es_instance_name: "{{ name }}", es_heap_size: "{{ elasticsearch_heap_size }}",
    es_config: {
        cluster.name: "{{ cluster_name }}",
        discovery.zen.ping.unicast.hosts: "{{ master_eligible }}",
        discovery.zen.minimum_master_nodes: "{{ minimum_master_nodes }}",
        http.port: 9200,
        transport.tcp.port: 9300,
        node.data: true,
        node.master: true,
        node.name: "{{ name }}",
        bootstrap.memory_lock: true,
        network.host: "0.0.0.0"
        }, tags: [ 'elk','elasticsearch' ] 
    }
    - { role: logstash, tags: [ 'elk','logstash' ]  }
    - { role: nginx, tags: [ 'elk','nginx' ]  }
    - { role: kibana, tags: [ 'elk','kibana' ]  }
    - { role: datadog, tags: [ 'datadog' ]  } 
