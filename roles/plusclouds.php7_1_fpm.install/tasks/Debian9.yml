---
##curl wget gnupg2 ca-certificates lsb-release apt-transport-https
- name: Install a list of packages
  apt:
    pkg:
      - curl
      - wget
      - gnupg2
      - ca-certificates
      - lsb-release
      - apt-transport-https

- name: Add apt key for Debian
  become: true
  apt_key: url=https://packages.sury.org/php/apt.gpg state=present
  when: ansible_distribution|lower == "debian"

- name: Add repository for Debian
  become: true
  apt_repository: repo="deb https://packages.sury.org/php/ $(lsb_release -sc) main" state=present

- name: Update apt
  become: yes
  apt: update_cache=yes

- name: Install PHP Packages
  become: yes
  apt: pkg={{ item }} state=latest
  with_items: "{{ php_packages }}"
  when: php_packages is defined
  notify:
    - restart php7-fpm

- name: Install a list of packages
  apt:
    pkg:
      - php7.1-fpm